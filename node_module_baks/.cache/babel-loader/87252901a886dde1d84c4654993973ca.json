{"ast":null,"code":"/**\n * Browser Image Compression\n * v1.0.13\n * by Donald <donaldcwl@gmail.com>\n * https://github.com/Donaldcwl/browser-image-compression\n */\nfunction _defineProperty(e, r, n) {\n  return r in e ? Object.defineProperty(e, r, {\n    value: n,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = n, e;\n}\n\nfunction ownKeys(e, r) {\n  var n = Object.keys(e);\n\n  if (Object.getOwnPropertySymbols) {\n    var t = Object.getOwnPropertySymbols(e);\n    r && (t = t.filter(function (r) {\n      return Object.getOwnPropertyDescriptor(e, r).enumerable;\n    })), n.push.apply(n, t);\n  }\n\n  return n;\n}\n\nfunction _objectSpread2(e) {\n  for (var r = 1; r < arguments.length; r++) {\n    var n = null != arguments[r] ? arguments[r] : {};\n    r % 2 ? ownKeys(Object(n), !0).forEach(function (r) {\n      _defineProperty(e, r, n[r]);\n    }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(n)) : ownKeys(Object(n)).forEach(function (r) {\n      Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(n, r));\n    });\n  }\n\n  return e;\n}\n\nfunction _slicedToArray(e, r) {\n  return function _arrayWithHoles(e) {\n    if (Array.isArray(e)) return e;\n  }(e) || function _iterableToArrayLimit(e, r) {\n    if (\"undefined\" == typeof Symbol || !(Symbol.iterator in Object(e))) return;\n    var n = [],\n        t = !0,\n        a = !1,\n        i = void 0;\n\n    try {\n      for (var o, s = e[Symbol.iterator](); !(t = (o = s.next()).done) && (n.push(o.value), !r || n.length !== r); t = !0);\n    } catch (e) {\n      a = !0, i = e;\n    } finally {\n      try {\n        t || null == s.return || s.return();\n      } finally {\n        if (a) throw i;\n      }\n    }\n\n    return n;\n  }(e, r) || function _unsupportedIterableToArray(e, r) {\n    if (!e) return;\n    if (\"string\" == typeof e) return _arrayLikeToArray(e, r);\n    var n = Object.prototype.toString.call(e).slice(8, -1);\n    \"Object\" === n && e.constructor && (n = e.constructor.name);\n    if (\"Map\" === n || \"Set\" === n) return Array.from(e);\n    if (\"Arguments\" === n || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(e, r);\n  }(e, r) || function _nonIterableRest() {\n    throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }();\n}\n\nfunction _arrayLikeToArray(e, r) {\n  (null == r || r > e.length) && (r = e.length);\n\n  for (var n = 0, t = new Array(r); n < r; n++) t[n] = e[n];\n\n  return t;\n}\n\nvar e = \"undefined\" != typeof window,\n    r = e && window.cordova && window.cordova.require && window.cordova.require(\"cordova/modulemapper\"),\n    CustomFile = e && (r && r.getOriginalSymbol(window, \"File\") || File),\n    CustomFileReader = e && (r && r.getOriginalSymbol(window, \"FileReader\") || FileReader),\n    n = e && new Promise(function (e, r) {\n  var n, t, a, i;\n  return getFilefromDataUrl(\"data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==\", \"test.jpg\", Date.now()).then(function (o) {\n    try {\n      return drawFileInCanvas(n = o).then(function (o) {\n        try {\n          return canvasToFile(t = o[1], n.type, n.name, n.lastModified).then(function (n) {\n            try {\n              return a = n, cleanupCanvasMemory(t), getDataUrlFromFile(a).then(function (n) {\n                try {\n                  return loadImage(n).then(function (n) {\n                    try {\n                      return e(1 === (i = n).width && 2 === i.height);\n                    } catch (e) {\n                      return r(e);\n                    }\n                  }, r);\n                } catch (e) {\n                  return r(e);\n                }\n              }, r);\n            } catch (e) {\n              return r(e);\n            }\n          }, r);\n        } catch (e) {\n          return r(e);\n        }\n      }, r);\n    } catch (e) {\n      return r(e);\n    }\n  }, r);\n});\n\nfunction getDataUrlFromFile(e) {\n  return new Promise(function (r, n) {\n    var t = new CustomFileReader();\n    t.onload = function () {\n      return r(t.result);\n    }, t.onerror = function (e) {\n      return n(e);\n    }, t.readAsDataURL(e);\n  });\n}\n\nfunction getFilefromDataUrl(e, r) {\n  var n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : Date.now();\n  return new Promise(function (t) {\n    for (var a = e.split(\",\"), i = a[0].match(/:(.*?);/)[1], o = window.atob(a[1]), s = o.length, c = new Uint8Array(s); s--;) c[s] = o.charCodeAt(s);\n\n    var u = new Blob([c], {\n      type: i\n    });\n    u.name = r, u.lastModified = n, t(u);\n  });\n}\n\nfunction loadImage(e) {\n  return new Promise(function (r, n) {\n    var t = new Image();\n    t.onload = function () {\n      return r(t);\n    }, t.onerror = function (e) {\n      return n(e);\n    }, t.src = e;\n  });\n}\n\nfunction drawImageInCanvas(e) {\n  var r = _slicedToArray(getNewCanvasAndCtx(e.width, e.height), 2),\n      n = r[0];\n\n  return r[1].drawImage(e, 0, 0, n.width, n.height), n;\n}\n\nfunction drawFileInCanvas(e) {\n  return new Promise(function (r, n) {\n    var t,\n        a,\n        i = function $Try_1_Post() {\n      try {\n        return a = drawImageInCanvas(t), r([t, a]);\n      } catch (e) {\n        return n(e);\n      }\n    },\n        o = function $Try_1_Catch(r) {\n      try {\n        return getDataUrlFromFile(e).then(function (e) {\n          try {\n            return loadImage(e).then(function (e) {\n              try {\n                return t = e, i();\n              } catch (e) {\n                return n(e);\n              }\n            }, n);\n          } catch (e) {\n            return n(e);\n          }\n        }, n);\n      } catch (e) {\n        return n(e);\n      }\n    };\n\n    try {\n      return createImageBitmap(e).then(function (e) {\n        try {\n          return t = e, i();\n        } catch (e) {\n          return o();\n        }\n      }, o);\n    } catch (e) {\n      o();\n    }\n  });\n}\n\nfunction canvasToFile(e, r, n, t) {\n  var a = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 1;\n  return new Promise(function (i, o) {\n    var s;\n    return \"function\" == typeof OffscreenCanvas && e instanceof OffscreenCanvas ? e.convertToBlob({\n      type: r,\n      quality: a\n    }).then(function (e) {\n      try {\n        return (s = e).name = n, s.lastModified = t, $If_4.call(this);\n      } catch (e) {\n        return o(e);\n      }\n    }.bind(this), o) : getFilefromDataUrl(e.toDataURL(r, a), n, t).then(function (e) {\n      try {\n        return s = e, $If_4.call(this);\n      } catch (e) {\n        return o(e);\n      }\n    }.bind(this), o);\n\n    function $If_4() {\n      return i(s);\n    }\n  });\n}\n\nfunction getExifOrientation(e) {\n  return new Promise(function (r, n) {\n    var t = new CustomFileReader();\n    t.onload = function (e) {\n      var n = new DataView(e.target.result);\n      if (65496 != n.getUint16(0, !1)) return r(-2);\n\n      for (var t = n.byteLength, a = 2; a < t;) {\n        if (n.getUint16(a + 2, !1) <= 8) return r(-1);\n        var i = n.getUint16(a, !1);\n\n        if (a += 2, 65505 == i) {\n          if (1165519206 != n.getUint32(a += 2, !1)) return r(-1);\n          var o = 18761 == n.getUint16(a += 6, !1);\n          a += n.getUint32(a + 4, o);\n          var s = n.getUint16(a, o);\n          a += 2;\n\n          for (var c = 0; c < s; c++) if (274 == n.getUint16(a + 12 * c, o)) return r(n.getUint16(a + 12 * c + 8, o));\n        } else {\n          if (65280 != (65280 & i)) break;\n          a += n.getUint16(a, !1);\n        }\n      }\n\n      return r(-1);\n    }, t.onerror = function (e) {\n      return n(e);\n    }, t.readAsArrayBuffer(e);\n  });\n}\n\nfunction handleMaxWidthOrHeight(e, r) {\n  var n,\n      t = e.width,\n      a = e.height,\n      i = r.maxWidthOrHeight,\n      o = e;\n\n  if (isFinite(i) && (t > i || a > i)) {\n    var s = _slicedToArray(getNewCanvasAndCtx(t, a), 2);\n\n    o = s[0], n = s[1], t > a ? (o.width = i, o.height = a / t * i) : (o.width = t / a * i, o.height = i), n.drawImage(e, 0, 0, o.width, o.height), cleanupCanvasMemory(e);\n  }\n\n  return o;\n}\n\nfunction followExifOrientation(e, r) {\n  var n = e.width,\n      t = e.height,\n      a = _slicedToArray(getNewCanvasAndCtx(n, t), 2),\n      i = a[0],\n      o = a[1];\n\n  switch (4 < r && r < 9 ? (i.width = t, i.height = n) : (i.width = n, i.height = t), r) {\n    case 2:\n      o.transform(-1, 0, 0, 1, n, 0);\n      break;\n\n    case 3:\n      o.transform(-1, 0, 0, -1, n, t);\n      break;\n\n    case 4:\n      o.transform(1, 0, 0, -1, 0, t);\n      break;\n\n    case 5:\n      o.transform(0, 1, 1, 0, 0, 0);\n      break;\n\n    case 6:\n      o.transform(0, 1, -1, 0, t, 0);\n      break;\n\n    case 7:\n      o.transform(0, -1, -1, 0, t, n);\n      break;\n\n    case 8:\n      o.transform(0, -1, 1, 0, 0, n);\n  }\n\n  return o.drawImage(e, 0, 0, n, t), cleanupCanvasMemory(e), i;\n}\n\nfunction getNewCanvasAndCtx(e, r) {\n  var n, t;\n\n  try {\n    if (null === (t = (n = new OffscreenCanvas(e, r)).getContext(\"2d\"))) throw new Error(\"getContext of OffscreenCanvas returns null\");\n  } catch (e) {\n    t = (n = document.createElement(\"canvas\")).getContext(\"2d\");\n  }\n\n  return n.width = e, n.height = r, [n, t];\n}\n\nfunction cleanupCanvasMemory(e) {\n  e.width = 0, e.height = 0;\n}\n\nfunction compress(e, r) {\n  return new Promise(function (t, a) {\n    var i, o, s, c, u, l, m, f, g, A, d, p, h, y, v, w, C, E;\n\n    function incProgress() {\n      var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : 5;\n      i += e, r.onProgress(Math.min(i, 100));\n    }\n\n    function setProgress(e) {\n      i = Math.min(Math.max(e, i), 100), r.onProgress(i);\n    }\n\n    return i = 0, o = r.maxIteration || 10, s = 1024 * r.maxSizeMB * 1024, incProgress(), drawFileInCanvas(e).then(function (i) {\n      try {\n        var b = _slicedToArray(i, 2);\n\n        return b[0], c = b[1], incProgress(), u = handleMaxWidthOrHeight(c, r), incProgress(), new Promise(function (n, t) {\n          var a;\n          if (!(a = r.exifOrientation)) return getExifOrientation(e).then(function (e) {\n            try {\n              return a = e, $If_2.call(this);\n            } catch (e) {\n              return t(e);\n            }\n          }.bind(this), t);\n\n          function $If_2() {\n            return n(a);\n          }\n\n          return $If_2.call(this);\n        }).then(function (i) {\n          try {\n            return l = i, incProgress(), n.then(function (n) {\n              try {\n                return m = n ? u : followExifOrientation(u, l), incProgress(), f = r.initialQuality || 1, \"image/jpeg\", g = r.fileType || e.type, canvasToFile(m, g, e.name, e.lastModified, f).then(function (r) {\n                  try {\n                    {\n                      if (A = r, incProgress(), d = A.size > s, p = A.size > e.size, !d && !p) return setProgress(100), t(A);\n                      var n;\n\n                      function $Loop_3() {\n                        if (o-- && (v > s || v > h)) {\n                          var r,\n                              n,\n                              t = _slicedToArray(getNewCanvasAndCtx(r = d ? .95 * E.width : E.width, n = d ? .95 * E.height : E.height), 2);\n\n                          return C = t[0], t[1].drawImage(E, 0, 0, r, n), f *= .95, canvasToFile(C, \"image/jpeg\", e.name, e.lastModified, f).then(function (e) {\n                            try {\n                              return w = e, cleanupCanvasMemory(E), E = C, v = w.size, setProgress(Math.min(99, Math.floor((y - v) / (y - s) * 100))), $Loop_3;\n                            } catch (e) {\n                              return a(e);\n                            }\n                          }, a);\n                        }\n\n                        return [1];\n                      }\n\n                      return h = e.size, y = A.size, v = y, E = m, (n = function (e) {\n                        for (; e;) {\n                          if (e.then) return void e.then(n, a);\n\n                          try {\n                            if (e.pop) {\n                              if (e.length) return e.pop() ? $Loop_3_exit.call(this) : e;\n                              e = $Loop_3;\n                            } else e = e.call(this);\n                          } catch (e) {\n                            return a(e);\n                          }\n                        }\n                      }.bind(this))($Loop_3);\n\n                      function $Loop_3_exit() {\n                        return \"image/jpeg\" !== g && ((w = new Blob([w], {\n                          type: g\n                        })).name = e.name, w.lastModified = e.lastModified), cleanupCanvasMemory(E), cleanupCanvasMemory(C), cleanupCanvasMemory(u), cleanupCanvasMemory(m), cleanupCanvasMemory(c), setProgress(100), t(w);\n                      }\n                    }\n                  } catch (e) {\n                    return a(e);\n                  }\n                }.bind(this), a);\n              } catch (e) {\n                return a(e);\n              }\n            }.bind(this), a);\n          } catch (e) {\n            return a(e);\n          }\n        }.bind(this), a);\n      } catch (e) {\n        return a(e);\n      }\n    }.bind(this), a);\n  });\n}\n\ne && (Number.isInteger = Number.isInteger || function (e) {\n  return \"number\" == typeof e && isFinite(e) && Math.floor(e) === e;\n});\nvar t,\n    a,\n    i = 0;\n\nfunction generateLib() {\n  return function createSourceObject(e) {\n    return URL.createObjectURL(new Blob([e], {\n      type: \"application/javascript\"\n    }));\n  }(\"\\n    function imageCompression (){return (\".concat(imageCompression, \").apply(null, arguments)}\\n\\n    imageCompression.getDataUrlFromFile = \").concat(imageCompression.getDataUrlFromFile, \"\\n    imageCompression.getFilefromDataUrl = \").concat(imageCompression.getFilefromDataUrl, \"\\n    imageCompression.loadImage = \").concat(imageCompression.loadImage, \"\\n    imageCompression.drawImageInCanvas = \").concat(imageCompression.drawImageInCanvas, \"\\n    imageCompression.drawFileInCanvas = \").concat(imageCompression.drawFileInCanvas, \"\\n    imageCompression.canvasToFile = \").concat(imageCompression.canvasToFile, \"\\n    imageCompression.getExifOrientation = \").concat(imageCompression.getExifOrientation, \"\\n    imageCompression.handleMaxWidthOrHeight = \").concat(imageCompression.handleMaxWidthOrHeight, \"\\n    imageCompression.followExifOrientation = \").concat(imageCompression.followExifOrientation, \"\\n    imageCompression.cleanupMemory = \").concat(imageCompression.cleanupMemory, \"\\n\\n    getDataUrlFromFile = imageCompression.getDataUrlFromFile\\n    getFilefromDataUrl = imageCompression.getFilefromDataUrl\\n    loadImage = imageCompression.loadImage\\n    drawImageInCanvas = imageCompression.drawImageInCanvas\\n    drawFileInCanvas = imageCompression.drawFileInCanvas\\n    canvasToFile = imageCompression.canvasToFile\\n    getExifOrientation = imageCompression.getExifOrientation\\n    handleMaxWidthOrHeight = imageCompression.handleMaxWidthOrHeight\\n    followExifOrientation = imageCompression.followExifOrientation\\n    cleanupMemory = imageCompression.cleanupMemory\\n\\n    getNewCanvasAndCtx = \").concat(getNewCanvasAndCtx, \"\\n    \\n    CustomFileReader = FileReader\\n    \\n    CustomFile = File\\n    \\n    function _slicedToArray(arr, n) { return arr }\\n    \\n    function _typeof(a) { return typeof a }\\n\\n    function compress (){return (\").concat(compress, \").apply(null, arguments)}\\n    \"));\n}\n\nfunction generateWorkerScript() {\n  return function createWorker(e) {\n    return \"function\" == typeof e && (e = \"(\".concat(f, \")()\")), new Worker(URL.createObjectURL(new Blob([e])));\n  }(\"\\n    let scriptImported = false\\n    self.addEventListener('message', async (e) => {\\n      const { file, id, imageCompressionLibUrl, options } = e.data\\n      options.onProgress = (progress) => self.postMessage({ progress, id })\\n      try {\\n        if (!scriptImported) {\\n          // console.log('[worker] importScripts', imageCompressionLibUrl)\\n          self.importScripts(imageCompressionLibUrl)\\n          scriptImported = true\\n        }\\n        // console.log('[worker] self', self)\\n        const compressedFile = await imageCompression(file, options)\\n        self.postMessage({ file: compressedFile, id })\\n      } catch (e) {\\n        // console.error('[worker] error', e)\\n        self.postMessage({ error: e.message + '\\\\n' + e.stack, id })\\n      }\\n    })\\n  \");\n}\n\nfunction imageCompression(e, r) {\n  return new Promise(function (n, o) {\n    var s, c, u;\n    if (r.maxSizeMB = r.maxSizeMB || Number.POSITIVE_INFINITY, c = \"boolean\" != typeof r.useWebWorker || r.useWebWorker, delete r.useWebWorker, void 0 === r.onProgress && (r.onProgress = function () {}), !(e instanceof Blob || e instanceof CustomFile)) return o(new Error(\"The file given is not an instance of Blob or File\"));\n    if (!/^image/.test(e.type)) return o(new Error(\"The file given is not an image\"));\n    if (u = \"undefined\" != typeof WorkerGlobalScope && self instanceof WorkerGlobalScope, !c || \"function\" != typeof Worker || u) return compress(e, r).then(function (e) {\n      try {\n        return s = e, $If_3.call(this);\n      } catch (e) {\n        return o(e);\n      }\n    }.bind(this), o);\n\n    var l = function () {\n      try {\n        return $If_3.call(this);\n      } catch (e) {\n        return o(e);\n      }\n    }.bind(this),\n        m = function $Try_1_Catch(n) {\n      try {\n        return compress(e, r).then(function (e) {\n          try {\n            return s = e, l();\n          } catch (e) {\n            return o(e);\n          }\n        }, o);\n      } catch (e) {\n        return o(e);\n      }\n    };\n\n    try {\n      return function compressOnWebWorker(e, r) {\n        return new Promise(function (n, o) {\n          return new Promise(function (s, c) {\n            var u = i++;\n            return t || (t = generateLib()), a || (a = generateWorkerScript()), a.addEventListener(\"message\", function handler(e) {\n              if (e.data.id === u) {\n                if (void 0 !== e.data.progress) return void r.onProgress(e.data.progress);\n                a.removeEventListener(\"message\", handler), e.data.error && o(new Error(e.data.error)), n(e.data.file);\n              }\n            }), a.addEventListener(\"error\", o), a.postMessage({\n              file: e,\n              id: u,\n              imageCompressionLibUrl: t,\n              options: _objectSpread2(_objectSpread2({}, r), {}, {\n                onProgress: void 0\n              })\n            }), s();\n          });\n        });\n      }(e, r).then(function (e) {\n        try {\n          return s = e, l();\n        } catch (e) {\n          return m();\n        }\n      }, m);\n    } catch (e) {\n      m();\n    }\n\n    function $If_3() {\n      try {\n        s.name = e.name, s.lastModified = e.lastModified;\n      } catch (e) {}\n\n      return n(s);\n    }\n  });\n}\n\nimageCompression.getDataUrlFromFile = getDataUrlFromFile, imageCompression.getFilefromDataUrl = getFilefromDataUrl, imageCompression.loadImage = loadImage, imageCompression.drawImageInCanvas = drawImageInCanvas, imageCompression.drawFileInCanvas = drawFileInCanvas, imageCompression.canvasToFile = canvasToFile, imageCompression.getExifOrientation = getExifOrientation, imageCompression.handleMaxWidthOrHeight = handleMaxWidthOrHeight, imageCompression.followExifOrientation = followExifOrientation, imageCompression.cleanupMemory = cleanupCanvasMemory, imageCompression.version = \"1.0.13\";\nexport default imageCompression;","map":{"version":3,"sources":["../lib/utils.js","../lib/image-compression.js","../lib/web-worker.js","../lib/index.js"],"names":["isBrowser","window","CustomFile","getFilefromDataUrl","n","bstr","file","img","e","type","fileName","canvas","offset","i","view","reject","width","ctx","maxWidthOrHeight","options","cnt","imageCompressionLibUrl","script","generateLib","imageCompression","getDataUrlFromFile"],"mappings":"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","sourcesContent":["const isBrowser = typeof window !== 'undefined' // change browser environment to support SSR\r\n\r\n// add support for cordova-plugin-file\r\nconst moduleMapper = isBrowser && window.cordova && window.cordova.require && window.cordova.require('cordova/modulemapper')\r\nexport const CustomFile = isBrowser && ((moduleMapper && moduleMapper.getOriginalSymbol(window, 'File')) || File)\r\nexport const CustomFileReader = isBrowser && ((moduleMapper && moduleMapper.getOriginalSymbol(window, 'FileReader')) || FileReader)\r\n\r\n// Check if browser supports automatic image orientation\r\n// see https://github.com/blueimp/JavaScript-Load-Image/blob/1e4df707821a0afcc11ea0720ee403b8759f3881/js/load-image-orientation.js#L37-L53\r\nexport const isAutoOrientationInBrowser = isBrowser && (async () => {\r\n  // black 2x1 JPEG, with the following meta information set:\r\n  // EXIF Orientation: 6 (Rotated 90Â° CCW)\r\n  const testImageURL =\r\n    'data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAA' +\r\n    'AAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBA' +\r\n    'QEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQE' +\r\n    'BAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/x' +\r\n    'ABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAA' +\r\n    'AAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q=='\r\n  const testImageFile = await getFilefromDataUrl(testImageURL, 'test.jpg', Date.now())\r\n\r\n  const testImageCanvas = (await drawFileInCanvas(testImageFile))[1]\r\n  const testImageFile2 = await canvasToFile(testImageCanvas, testImageFile.type, testImageFile.name, testImageFile.lastModified)\r\n  cleanupCanvasMemory(testImageCanvas)\r\n  const testImageURL2 = await getDataUrlFromFile(testImageFile2)\r\n  const img = await loadImage(testImageURL2)\r\n  // console.log('img', img.width, img.height)\r\n\r\n  return img.width === 1 && img.height === 2\r\n})()\r\n\r\n/**\r\n * getDataUrlFromFile\r\n *\r\n * @param {File | Blob} file\r\n * @returns {Promise<string>}\r\n */\r\nexport function getDataUrlFromFile (file) {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new CustomFileReader()\r\n    reader.onload = () => resolve(reader.result)\r\n    reader.onerror = (e) => reject(e)\r\n    reader.readAsDataURL(file)\r\n  })\r\n}\r\n\r\n/**\r\n * getFilefromDataUrl\r\n *\r\n * @param {string} dataUrl\r\n * @param {string} filename\r\n * @param {number} [lastModified=Date.now()]\r\n * @returns {Promise<File | Blob>}\r\n */\r\nexport function getFilefromDataUrl (dataUrl, filename, lastModified = Date.now()) {\r\n  return new Promise((resolve) => {\r\n    const arr = dataUrl.split(',')\r\n    const mime = arr[0].match(/:(.*?);/)[1]\r\n    const bstr = window.atob(arr[1])\r\n    let n = bstr.length\r\n    const u8arr = new Uint8Array(n)\r\n    while (n--) {\r\n      u8arr[n] = bstr.charCodeAt(n)\r\n    }\r\n    const file = new Blob([u8arr], { type: mime })\r\n    file.name = filename\r\n    file.lastModified = lastModified\r\n    resolve(file)\r\n\r\n    // Safari has issue with File constructor not being able to POST in FormData\r\n    // https://github.com/Donaldcwl/browser-image-compression/issues/8\r\n    // https://bugs.webkit.org/show_bug.cgi?id=165081\r\n    // let file\r\n    // try {\r\n    //   file = new File([u8arr], filename, { type: mime }) // Edge do not support File constructor\r\n    // } catch (e) {\r\n    //   file = new Blob([u8arr], { type: mime })\r\n    //   file.name = filename\r\n    //   file.lastModified = lastModified\r\n    // }\r\n    // resolve(file)\r\n  })\r\n}\r\n\r\n/**\r\n * loadImage\r\n *\r\n * @param {string} src\r\n * @returns {Promise<HTMLImageElement>}\r\n */\r\nexport function loadImage (src) {\r\n  return new Promise((resolve, reject) => {\r\n    const img = new Image()\r\n    img.onload = () => resolve(img)\r\n    img.onerror = (e) => reject(e)\r\n    img.src = src\r\n  })\r\n}\r\n\r\n/**\r\n * drawImageInCanvas\r\n *\r\n * @param {HTMLImageElement} img\r\n * @returns {HTMLCanvasElement | OffscreenCanvas}\r\n */\r\nexport function drawImageInCanvas (img) {\r\n  const [canvas, ctx] = getNewCanvasAndCtx(img.width, img.height)\r\n  ctx.drawImage(img, 0, 0, canvas.width, canvas.height)\r\n  return canvas\r\n}\r\n\r\n/**\r\n * drawFileInCanvas\r\n *\r\n * @param {File | Blob} file\r\n * @returns {Promise<[ImageBitmap | HTMLImageElement, HTMLCanvasElement | OffscreenCanvas]>}\r\n */\r\nexport async function drawFileInCanvas (file) {\r\n  let img\r\n  try {\r\n    img = await createImageBitmap(file)\r\n  } catch (e) {\r\n    const dataUrl = await getDataUrlFromFile(file)\r\n    img = await loadImage(dataUrl)\r\n  }\r\n  const canvas = drawImageInCanvas(img)\r\n  return [img, canvas]\r\n}\r\n\r\n/**\r\n * canvasToFile\r\n *\r\n * @param {HTMLCanvasElement | OffscreenCanvas} canvas\r\n * @param {string} fileType\r\n * @param {string} fileName\r\n * @param {number} fileLastModified\r\n * @param {number} [quality]\r\n * @returns {Promise<File | Blob>}\r\n */\r\nexport async function canvasToFile (canvas, fileType, fileName, fileLastModified, quality = 1) {\r\n  let file\r\n  if (typeof OffscreenCanvas === 'function' && canvas instanceof OffscreenCanvas) { // checked on Win Chrome 83, MacOS Chrome 83\r\n    file = await canvas.convertToBlob({ type: fileType, quality })\r\n    file.name = fileName\r\n    file.lastModified = fileLastModified\r\n  // some browser do not support quality parameter, see: https://developer.mozilla.org/en-US/docs/Web/API/HTMLCanvasElement/toBlob\r\n  // } else if (typeof canvas.toBlob === 'function') {\r\n  //   file = await new Promise(resolve => canvas.toBlob(resolve, fileType, quality))\r\n  } else { // checked on Win Edge 44, Win IE 11, Win Firefox 76, MacOS Firefox 77, MacOS Safari 13.1\r\n    const dataUrl = canvas.toDataURL(fileType, quality)\r\n    file = await getFilefromDataUrl(dataUrl, fileName, fileLastModified)\r\n  }\r\n  return file\r\n}\r\n\r\n/**\r\n * getExifOrientation\r\n * get image exif orientation info\r\n * source: https://stackoverflow.com/a/32490603/10395024\r\n *\r\n * @param {File | Blob} file\r\n * @returns {Promise<number>} - orientation id, see https://i.stack.imgur.com/VGsAj.gif\r\n */\r\nexport function getExifOrientation (file) {\r\n  return new Promise((resolve, reject) => {\r\n    const reader = new CustomFileReader()\r\n    reader.onload = (e) => {\r\n      const view = new DataView(e.target.result)\r\n      if (view.getUint16(0, false) != 0xFFD8) {\r\n        return resolve(-2)\r\n      }\r\n      const length = view.byteLength\r\n      let offset = 2\r\n      while (offset < length) {\r\n        if (view.getUint16(offset + 2, false) <= 8) return resolve(-1)\r\n        const marker = view.getUint16(offset, false)\r\n        offset += 2\r\n        if (marker == 0xFFE1) {\r\n          if (view.getUint32(offset += 2, false) != 0x45786966) {\r\n            return resolve(-1)\r\n          }\r\n\r\n          var little = view.getUint16(offset += 6, false) == 0x4949\r\n          offset += view.getUint32(offset + 4, little)\r\n          var tags = view.getUint16(offset, little)\r\n          offset += 2\r\n          for (var i = 0; i < tags; i++) {\r\n            if (view.getUint16(offset + (i * 12), little) == 0x0112) {\r\n              return resolve(view.getUint16(offset + (i * 12) + 8, little))\r\n            }\r\n          }\r\n        } else if ((marker & 0xFF00) != 0xFF00) {\r\n          break\r\n        } else {\r\n          offset += view.getUint16(offset, false)\r\n        }\r\n      }\r\n      return resolve(-1)\r\n    }\r\n    reader.onerror = (e) => reject(e)\r\n    reader.readAsArrayBuffer(file)\r\n  })\r\n}\r\n\r\n/**\r\n *\r\n * @param {HTMLCanvasElement | OffscreenCanvas} canvas\r\n * @param options\r\n * @returns {HTMLCanvasElement | OffscreenCanvas}\r\n */\r\nexport function handleMaxWidthOrHeight (canvas, options) {\r\n  const width = canvas.width\r\n  const height = canvas.height\r\n  const maxWidthOrHeight = options.maxWidthOrHeight\r\n\r\n  const needToHandle = isFinite(maxWidthOrHeight) && (width > maxWidthOrHeight || height > maxWidthOrHeight)\r\n\r\n  let newCanvas = canvas\r\n  let ctx\r\n\r\n  if (needToHandle) {\r\n    [newCanvas, ctx] = getNewCanvasAndCtx(width, height)\r\n    if (width > height) {\r\n      newCanvas.width = maxWidthOrHeight\r\n      newCanvas.height = (height / width) * maxWidthOrHeight\r\n    } else {\r\n      newCanvas.width = (width / height) * maxWidthOrHeight\r\n      newCanvas.height = maxWidthOrHeight\r\n    }\r\n    ctx.drawImage(canvas, 0, 0, newCanvas.width, newCanvas.height)\r\n\r\n    cleanupCanvasMemory(canvas)\r\n  }\r\n\r\n  return newCanvas\r\n}\r\n\r\n/**\r\n * followExifOrientation\r\n * source: https://stackoverflow.com/a/40867559/10395024\r\n *\r\n * @param {HTMLCanvasElement | OffscreenCanvas} canvas\r\n * @param {number} exifOrientation\r\n * @returns {HTMLCanvasElement | OffscreenCanvas} canvas\r\n */\r\nexport function followExifOrientation (canvas, exifOrientation) {\r\n  const width = canvas.width\r\n  const height = canvas.height\r\n\r\n  const [newCanvas, ctx] = getNewCanvasAndCtx(width, height)\r\n\r\n  // set proper canvas dimensions before transform & export\r\n  if (4 < exifOrientation && exifOrientation < 9) {\r\n    newCanvas.width = height\r\n    newCanvas.height = width\r\n  } else {\r\n    newCanvas.width = width\r\n    newCanvas.height = height\r\n  }\r\n\r\n  // transform context before drawing image\r\n  switch (exifOrientation) {\r\n    case 2:\r\n      ctx.transform(-1, 0, 0, 1, width, 0)\r\n      break\r\n    case 3:\r\n      ctx.transform(-1, 0, 0, -1, width, height)\r\n      break\r\n    case 4:\r\n      ctx.transform(1, 0, 0, -1, 0, height)\r\n      break\r\n    case 5:\r\n      ctx.transform(0, 1, 1, 0, 0, 0)\r\n      break\r\n    case 6:\r\n      ctx.transform(0, 1, -1, 0, height, 0)\r\n      break\r\n    case 7:\r\n      ctx.transform(0, -1, -1, 0, height, width)\r\n      break\r\n    case 8:\r\n      ctx.transform(0, -1, 1, 0, 0, width)\r\n      break\r\n    default:\r\n      break\r\n  }\r\n\r\n  ctx.drawImage(canvas, 0, 0, width, height)\r\n\r\n  cleanupCanvasMemory(canvas)\r\n\r\n  return newCanvas\r\n}\r\n\r\n/**\r\n * get new Canvas and it's context\r\n * @param width\r\n * @param height\r\n * @returns {[HTMLCanvasElement | OffscreenCanvas, CanvasRenderingContext2D]}\r\n */\r\nexport function getNewCanvasAndCtx (width, height) {\r\n  let canvas\r\n  let ctx\r\n  try {\r\n    canvas = new OffscreenCanvas(width, height)\r\n    ctx = canvas.getContext('2d')\r\n    if (ctx === null) {\r\n      throw new Error('getContext of OffscreenCanvas returns null')\r\n    }\r\n  } catch (e) {\r\n    canvas = document.createElement('canvas')\r\n    ctx = canvas.getContext('2d')\r\n  }\r\n  canvas.width = width\r\n  canvas.height = height\r\n  return [canvas, ctx]\r\n}\r\n\r\n/**\r\n * clear Canvas memory\r\n * @param canvas\r\n * @returns null\r\n */\r\nexport function cleanupCanvasMemory (canvas) {\r\n  // garbage clean canvas for safari\r\n  // ref: https://bugs.webkit.org/show_bug.cgi?id=195325\r\n  canvas.width = 0\r\n  canvas.height = 0\r\n}\r\n\r\nif (isBrowser) {\r\n// Polyfill for Number.isInteger\r\n  Number.isInteger = Number.isInteger || function (value) {\r\n    return typeof value === 'number' &&\r\n      isFinite(value) &&\r\n      Math.floor(value) === value\r\n  }\r\n}\r\n","import {\r\n  canvasToFile,\r\n  cleanupCanvasMemory,\r\n  drawFileInCanvas,\r\n  followExifOrientation,\r\n  getExifOrientation,\r\n  getNewCanvasAndCtx,\r\n  handleMaxWidthOrHeight,\r\n  isAutoOrientationInBrowser\r\n} from './utils'\r\n\r\n/**\r\n * Compress an image file.\r\n *\r\n * @param {File} file\r\n * @param {Object} options\r\n * @param {number} [options.maxSizeMB=Number.POSITIVE_INFINITY]\r\n * @param {number} [options.maxWidthOrHeight=undefined]\r\n * @param {boolean} [options.useWebWorker=false]\r\n * @param {number} [options.maxIteration=10]\r\n * @param {number} [options.exifOrientation] - default to be the exif orientation from the image file\r\n * @param {Function} [options.onProgress] - a function takes one progress argument (progress from 0 to 100)\r\n * @param {string} [options.fileType] - default to be the original mime type from the image file\r\n * @param {number} [options.initialQuality=1.0]\r\n * @returns {Promise<File | Blob>}\r\n */\r\nexport default async function compress (file, options) {\r\n  let progress = 0\r\n\r\n  function incProgress (inc = 5) {\r\n    progress += inc\r\n    options.onProgress(Math.min(progress, 100))\r\n  }\r\n\r\n  function setProgress (p) {\r\n    progress = Math.min(Math.max(p, progress), 100)\r\n    options.onProgress(progress)\r\n  }\r\n\r\n  let remainingTrials = options.maxIteration || 10\r\n\r\n  const maxSizeByte = options.maxSizeMB * 1024 * 1024\r\n\r\n  incProgress()\r\n\r\n  // drawFileInCanvas\r\n  let [img, origCanvas] = await drawFileInCanvas(file)\r\n\r\n  incProgress()\r\n\r\n  // handleMaxWidthOrHeight\r\n  const maxWidthOrHeightFixedCanvas = handleMaxWidthOrHeight(origCanvas, options)\r\n\r\n  incProgress()\r\n\r\n  // exifOrientation\r\n  const exifOrientation = options.exifOrientation || await getExifOrientation(file)\r\n  incProgress()\r\n  const orientationFixedCanvas = (await isAutoOrientationInBrowser) ? maxWidthOrHeightFixedCanvas : followExifOrientation(maxWidthOrHeightFixedCanvas, exifOrientation)\r\n  incProgress()\r\n\r\n  let quality = options.initialQuality || 1.0\r\n\r\n  const tempFileType = 'image/jpeg'\r\n  const outputFileType = options.fileType || file.type\r\n\r\n  let tempFile = await canvasToFile(orientationFixedCanvas, outputFileType, file.name, file.lastModified, quality)\r\n  incProgress()\r\n\r\n  const origExceedMaxSize = tempFile.size > maxSizeByte\r\n  const sizeBecomeLarger = tempFile.size > file.size\r\n  // console.log('original file size', file.size)\r\n  // console.log('current file size', tempFile.size)\r\n\r\n  // check if we need to compress or resize\r\n  if (!origExceedMaxSize && !sizeBecomeLarger) {\r\n    // no need to compress\r\n    setProgress(100)\r\n    return tempFile\r\n  }\r\n\r\n  const sourceSize = file.size\r\n  const renderedSize = tempFile.size\r\n  let currentSize = renderedSize\r\n  let compressedFile\r\n  let newCanvas, ctx\r\n  let canvas = orientationFixedCanvas\r\n  while (remainingTrials-- && (currentSize > maxSizeByte || currentSize > sourceSize)) {\r\n    const newWidth = origExceedMaxSize ? canvas.width * 0.95 : canvas.width\r\n    const newHeight = origExceedMaxSize ? canvas.height * 0.95 : canvas.height;\r\n    // console.log('current width', newWidth);\r\n    // console.log('current height', newHeight);\r\n    [newCanvas, ctx] = getNewCanvasAndCtx(newWidth, newHeight)\r\n\r\n    ctx.drawImage(canvas, 0, 0, newWidth, newHeight)\r\n\r\n    if (tempFileType === 'image/jpeg') {\r\n      quality *= 0.95\r\n    }\r\n    compressedFile = await canvasToFile(newCanvas, tempFileType, file.name, file.lastModified, quality)\r\n\r\n    cleanupCanvasMemory(canvas)\r\n\r\n    canvas = newCanvas\r\n\r\n    currentSize = compressedFile.size\r\n    setProgress(Math.min(99, Math.floor((renderedSize - currentSize) / (renderedSize - maxSizeByte) * 100)))\r\n  }\r\n  if (tempFileType !== outputFileType) {\r\n    compressedFile = new Blob([compressedFile], { type: outputFileType })\r\n    compressedFile.name = file.name\r\n    compressedFile.lastModified = file.lastModified\r\n  }\r\n\r\n  cleanupCanvasMemory(canvas)\r\n  cleanupCanvasMemory(newCanvas)\r\n  cleanupCanvasMemory(maxWidthOrHeightFixedCanvas)\r\n  cleanupCanvasMemory(orientationFixedCanvas)\r\n  cleanupCanvasMemory(origCanvas)\r\n\r\n  setProgress(100)\r\n  return compressedFile\r\n}\r\n","import lib from './index'\r\nimport compress from './image-compression'\r\nimport { getNewCanvasAndCtx } from './utils'\r\n\r\nlet cnt = 0\r\nlet imageCompressionLibUrl\r\nlet worker\r\n\r\nfunction createWorker (script) {\r\n  if (typeof script === 'function') {\r\n    script = `(${f})()`\r\n  }\r\n  return new Worker(URL.createObjectURL(new Blob([script])))\r\n}\r\n\r\nfunction createSourceObject (str) {\r\n  return URL.createObjectURL(new Blob([str], { type: 'application/javascript' }))\r\n}\r\n\r\nfunction generateLib () {\r\n  // prepare the lib to be used inside WebWorker\r\n  return createSourceObject(`\r\n    function imageCompression (){return (${lib}).apply(null, arguments)}\r\n\r\n    imageCompression.getDataUrlFromFile = ${lib.getDataUrlFromFile}\r\n    imageCompression.getFilefromDataUrl = ${lib.getFilefromDataUrl}\r\n    imageCompression.loadImage = ${lib.loadImage}\r\n    imageCompression.drawImageInCanvas = ${lib.drawImageInCanvas}\r\n    imageCompression.drawFileInCanvas = ${lib.drawFileInCanvas}\r\n    imageCompression.canvasToFile = ${lib.canvasToFile}\r\n    imageCompression.getExifOrientation = ${lib.getExifOrientation}\r\n    imageCompression.handleMaxWidthOrHeight = ${lib.handleMaxWidthOrHeight}\r\n    imageCompression.followExifOrientation = ${lib.followExifOrientation}\r\n    imageCompression.cleanupMemory = ${lib.cleanupMemory}\r\n\r\n    getDataUrlFromFile = imageCompression.getDataUrlFromFile\r\n    getFilefromDataUrl = imageCompression.getFilefromDataUrl\r\n    loadImage = imageCompression.loadImage\r\n    drawImageInCanvas = imageCompression.drawImageInCanvas\r\n    drawFileInCanvas = imageCompression.drawFileInCanvas\r\n    canvasToFile = imageCompression.canvasToFile\r\n    getExifOrientation = imageCompression.getExifOrientation\r\n    handleMaxWidthOrHeight = imageCompression.handleMaxWidthOrHeight\r\n    followExifOrientation = imageCompression.followExifOrientation\r\n    cleanupMemory = imageCompression.cleanupMemory\r\n\r\n    getNewCanvasAndCtx = ${getNewCanvasAndCtx}\r\n    \r\n    CustomFileReader = FileReader\r\n    \r\n    CustomFile = File\r\n    \r\n    function _slicedToArray(arr, n) { return arr }\r\n    \r\n    function _typeof(a) { return typeof a }\r\n\r\n    function compress (){return (${compress}).apply(null, arguments)}\r\n    `)\r\n}\r\n\r\nfunction generateWorkerScript () {\r\n  // code to be run in the WebWorker\r\n  return createWorker(`\r\n    let scriptImported = false\r\n    self.addEventListener('message', async (e) => {\r\n      const { file, id, imageCompressionLibUrl, options } = e.data\r\n      options.onProgress = (progress) => self.postMessage({ progress, id })\r\n      try {\r\n        if (!scriptImported) {\r\n          // console.log('[worker] importScripts', imageCompressionLibUrl)\r\n          self.importScripts(imageCompressionLibUrl)\r\n          scriptImported = true\r\n        }\r\n        // console.log('[worker] self', self)\r\n        const compressedFile = await imageCompression(file, options)\r\n        self.postMessage({ file: compressedFile, id })\r\n      } catch (e) {\r\n        // console.error('[worker] error', e)\r\n        self.postMessage({ error: e.message + '\\\\n' + e.stack, id })\r\n      }\r\n    })\r\n  `)\r\n}\r\n\r\nexport function compressOnWebWorker (file, options) {\r\n  return new Promise(async (resolve, reject) => {\r\n    let id = cnt++\r\n\r\n    if (!imageCompressionLibUrl) {\r\n      imageCompressionLibUrl = generateLib()\r\n    }\r\n\r\n    if (!worker) {\r\n      worker = generateWorkerScript()\r\n    }\r\n\r\n    function handler (e) {\r\n      if (e.data.id === id) {\r\n        if (e.data.progress !== undefined) {\r\n          options.onProgress(e.data.progress)\r\n          return\r\n        }\r\n        worker.removeEventListener('message', handler)\r\n        if (e.data.error) {\r\n          reject(new Error(e.data.error))\r\n        }\r\n        resolve(e.data.file)\r\n      }\r\n    }\r\n\r\n    worker.addEventListener('message', handler)\r\n    worker.addEventListener('error', reject)\r\n\r\n    worker.postMessage({\r\n      file,\r\n      id,\r\n      imageCompressionLibUrl,\r\n      options: { ...options, onProgress: undefined }\r\n    })\r\n  })\r\n}\r\n","import compress from './image-compression'\r\nimport {\r\n  canvasToFile,\r\n  drawFileInCanvas,\r\n  drawImageInCanvas,\r\n  getDataUrlFromFile,\r\n  getFilefromDataUrl,\r\n  loadImage,\r\n  getExifOrientation,\r\n  handleMaxWidthOrHeight,\r\n  followExifOrientation,\r\n  CustomFile,\r\n  cleanupCanvasMemory\r\n} from './utils'\r\nimport { compressOnWebWorker } from './web-worker'\r\n\r\n/**\r\n * Compress an image file.\r\n *\r\n * @param {File} file\r\n * @param {Object} options - { maxSizeMB=Number.POSITIVE_INFINITY, maxWidthOrHeight, useWebWorker=false, maxIteration = 10, exifOrientation, fileType }\r\n * @param {number} [options.maxSizeMB=Number.POSITIVE_INFINITY]\r\n * @param {number} [options.maxWidthOrHeight=undefined]\r\n * @param {boolean} [options.useWebWorker=false]\r\n * @param {number} [options.maxIteration=10]\r\n * @param {number} [options.exifOrientation] - default to be the exif orientation from the image file\r\n * @param {Function} [options.onProgress] - a function takes one progress argument (progress from 0 to 100)\r\n * @param {string} [options.fileType] - default to be the original mime type from the image file\r\n * @returns {Promise<File | Blob>}\r\n */\r\nasync function imageCompression (file, options) {\r\n\r\n  let compressedFile\r\n\r\n  options.maxSizeMB = options.maxSizeMB || Number.POSITIVE_INFINITY\r\n  const useWebWorker = typeof options.useWebWorker === 'boolean' ? options.useWebWorker : true\r\n  delete options.useWebWorker\r\n  if (options.onProgress === undefined) {\r\n    options.onProgress = () => {}\r\n  }\r\n\r\n  if (!(file instanceof Blob || file instanceof CustomFile)) {\r\n    throw new Error('The file given is not an instance of Blob or File')\r\n  } else if (!/^image/.test(file.type)) {\r\n    throw new Error('The file given is not an image')\r\n  }\r\n\r\n  // try run in web worker, fall back to run in main thread\r\n  const inWebWorker = typeof WorkerGlobalScope !== 'undefined' && self instanceof WorkerGlobalScope\r\n\r\n  // if ((useWebWorker && typeof Worker === 'function') || inWebWorker) {\r\n  //   console.log('run compression in web worker')\r\n  // } else {\r\n  //   console.log('run compression in main thread')\r\n  // }\r\n\r\n  if (useWebWorker && typeof Worker === 'function' && !inWebWorker) {\r\n    try {\r\n      // console.log(1)\r\n      // \"compressOnWebWorker\" is kind of like a recursion to call \"imageCompression\" again inside web worker\r\n      compressedFile = await compressOnWebWorker(file, options)\r\n    } catch (e) {\r\n      // console.warn('Run compression in web worker failed:', e, ', fall back to main thread')\r\n      // console.log(1.5)\r\n      compressedFile = await compress(file, options)\r\n    }\r\n  } else {\r\n    // console.log(2)\r\n    compressedFile = await compress(file, options)\r\n  }\r\n\r\n  try {\r\n    compressedFile.name = file.name\r\n    compressedFile.lastModified = file.lastModified\r\n  } catch (e) {}\r\n\r\n  return compressedFile\r\n}\r\n\r\nimageCompression.getDataUrlFromFile = getDataUrlFromFile\r\nimageCompression.getFilefromDataUrl = getFilefromDataUrl\r\nimageCompression.loadImage = loadImage\r\nimageCompression.drawImageInCanvas = drawImageInCanvas\r\nimageCompression.drawFileInCanvas = drawFileInCanvas\r\nimageCompression.canvasToFile = canvasToFile\r\nimageCompression.getExifOrientation = getExifOrientation\r\n\r\nimageCompression.handleMaxWidthOrHeight = handleMaxWidthOrHeight\r\nimageCompression.followExifOrientation = followExifOrientation\r\nimageCompression.cleanupMemory = cleanupCanvasMemory\r\nimageCompression.version = '1.0.13'\r\n\r\nexport default imageCompression\r\n"]},"metadata":{},"sourceType":"module"}